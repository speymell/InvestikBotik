# üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ InvestBot –Ω–∞ Yandex Cloud

## –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–Ω–∞ VM + SQLite (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)

#### 1. –°–æ–∑–¥–∞–π—Ç–µ VM —á–µ—Ä–µ–∑ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å:
- **Compute Cloud** ‚Üí **–°–æ–∑–¥–∞—Ç—å –í–ú**
- **–û–±—Ä–∞–∑**: Ubuntu 22.04 LTS
- **vCPU**: 2, **RAM**: 2 –ì–ë, **–î–∏—Å–∫**: 20 –ì–ë
- **–ü—É–±–ª–∏—á–Ω—ã–π IP**: –î–∞
- **SSH –∫–ª—é—á**: –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á

#### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ:

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VM
ssh ubuntu@<external-ip>

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo apt update && sudo apt upgrade -y
sudo apt install python3 python3-pip python3-venv git nginx -y

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
git clone <your-repo-url> investbot
cd investbot

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
cp .env.example .env
nano .env  # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

#### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
python app.py &  # –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ctrl+C –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î
python stock_parser.py
python demo_data.py

# –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
nohup python -m gunicorn -w 2 -b 0.0.0.0:8000 wsgi:app &
```

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx:

```bash
sudo nano /etc/nginx/sites-available/default
```

```nginx
server {
    listen 80 default_server;
    server_name _;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /static {
        alias /home/ubuntu/investbot/static;
    }
}
```

```bash
sudo systemctl reload nginx
```

**–ì–æ—Ç–æ–≤–æ!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ IP –∞–¥—Ä–µ—Å—É VM.

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: VM + Managed PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

#### 1. –°–æ–∑–¥–∞–π—Ç–µ PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä:
- **Managed Service for PostgreSQL**
- **–ö–ª–∞—Å—Å**: s2.micro
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: 10 –ì–ë
- **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –î–∞ (–¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è)

#### 2. –°–æ–∑–¥–∞–π—Ç–µ VM (–∫–∞–∫ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ 1)

#### 3. –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª:

```env
SECRET_KEY=your-secret-key-here
FLASK_ENV=production
DATABASE_URL=postgresql://user:password@c-xxxxx.rw.mdb.yandexcloud.net:6432/investbot
TELEGRAM_BOT_TOKEN=your-bot-token
WEB_APP_URL=http://your-vm-ip
```

#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–∞–∫ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ 1)

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: Serverless (–¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å serverless –ø–æ–¥—Ö–æ–¥:

#### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Serverless Containers**:

```dockerfile
# Dockerfile
FROM python:3.11-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8080

CMD ["gunicorn", "-b", "0.0.0.0:8080", "wsgi:app"]
```

#### 2. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```bash
# –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker build -t investbot .

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Container Registry
yc container registry create --name investbot-registry
docker tag investbot cr.yandex/your-registry-id/investbot:latest
docker push cr.yandex/your-registry-id/investbot:latest
```

#### 3. –°–æ–∑–¥–∞–π—Ç–µ Serverless Container:

```bash
yc serverless container create --name investbot-container
yc serverless container revision deploy \
  --container-name investbot-container \
  --image cr.yandex/your-registry-id/investbot:latest \
  --memory 1GB \
  --execution-timeout 30s
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –≤–∞—Ä–∏–∞–Ω—Ç–∞:

### –í–∞—Ä–∏–∞–Ω—Ç 1 (VM + SQLite) - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
**–ü–ª—é—Å—ã:**
- –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (~1,500‚ÇΩ/–º–µ—Å)
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 2 (VM + PostgreSQL) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π
**–ü–ª—é—Å—ã:**
- –ù–∞–¥–µ–∂–Ω–∞—è –ë–î —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–ú–∏–Ω—É—Å—ã:**
- –í—ã—à–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å (~4,000‚ÇΩ/–º–µ—Å)
- –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 3 (Serverless) - –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
**–ü–ª—é—Å—ã:**
- –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø–ª–∞—Ç–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ–¥–∞
- –•–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
ps aux | grep gunicorn

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pkill -f gunicorn
nohup python -m gunicorn -w 2 -b 0.0.0.0:8000 wsgi:app &

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f nohup.out

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∞–∫—Ü–∏–π
cd /home/ubuntu/investbot
source venv/bin/activate
python update_prices.py

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ (–¥–ª—è SQLite)
cp investbot.db investbot_backup_$(date +%Y%m%d).db
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω** (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
2. **–ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (Let's Encrypt –∏–ª–∏ Certificate Manager)
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –≤ Yandex Monitoring
4. **–°–æ–∑–¥–∞–π—Ç–µ Telegram –±–æ—Ç–∞** –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω** (cron)
6. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**

–ù–∞—á–Ω–∏—Ç–µ —Å –í–∞—Ä–∏–∞–Ω—Ç–∞ 1 –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –í–∞—Ä–∏–∞–Ω—Ç—É 2 –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!
